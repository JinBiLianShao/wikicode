!function(s,a){var t=s(".ins-search"),n=t.find(".ins-search-input"),o=t.find(".ins-section-wrapper"),c=t.find(".ins-section-container");function u(n,t,e,r,i){return s("<div>").addClass("ins-selectable").addClass("ins-search-item").append(s("<header>").append(s("<i>").addClass("fa").addClass("fa-"+n)).append(null!=t&&""!=t?t:a.TRANSLATION.UNTITLED).append(e?s("<span>").addClass("ins-slug").text(e):null)).append(r?s("<p>").addClass("ins-search-preview").html(r):null).attr("data-url",i)}function l(n,t,e){var r,i=p(n);if(0===e.length)return null;switch(n=a.TRANSLATION[t],t){case"POSTS":case"PAGES":r=e.map(function(e){var n=20<e.firstOccur?e.firstOccur-20:0,r="";return delete e.firstOccur,i.forEach(function(n){var t=new RegExp(n,"gi");r=e.text.replace(t,'<em class="search-keyword"> '+n+" </em>")}),r=r?r.slice(n,80+n):e.text.slice(0,80),u("file",e.title,null,r,a.ROOT_URL+e.path)});break;case"CATEGORIES":case"TAGS":r=e.map(function(n){return u("CATEGORIES"===t?"folder":"tag",n.name,n.slug,null,n.permalink)});break;default:return null}return n=n,s("<section>").addClass("ins-section").append(s("<header>").addClass("ins-section-header").text(n)).append(r)}function f(n,t){var e={},r=(n.pages.concat(n.posts).forEach(function(n){n[t]&&n[t].forEach(function(n){e[n.name]=n})}),[]);for(t in e)r.push(e[t]);return r}function p(n){return n.split(" ").filter(function(n){return!!n}).map(function(n){return n.toUpperCase()})}function d(n,r,t){n=p(n);return n.filter(function(e){return 0<t.filter(function(n){var t;return!!r.hasOwnProperty(n)&&(-1<(t=r[n].toUpperCase().indexOf(e))?("text"==n&&(r.firstOccur=t),!0):void 0)}).length}).length===n.length}function h(n,r,t,i){var s=0;return p(n).forEach(function(n){var e=new RegExp(n,"img");t.forEach(function(n,t){r.hasOwnProperty(n)&&(n=r[n].match(e),s+=n?n.length*i[t]:0)})}),s}function g(n,t){var e,r,i={POST:function(n){return h(e,n,["title","text"],[3,1])},PAGE:function(n){return h(e,n,["title","text"],[3,1])},CATEGORY:function(n){return h(e,n,["name","slug"],[1,1])},TAG:function(n){return h(e,n,["name","slug"],[1,1])}},t=(r=e=t,{POST:function(n){return d(r,n,["title","text"])},PAGE:function(n){return d(r,n,["title","text"])},CATEGORY:function(n){return d(r,n,["name","slug"])},TAG:function(n){return d(r,n,["name","slug"])}}),s=n.posts,a=n.pages,o=f(n,"tags"),n=f(n,"categories");return{posts:s.filter(t.POST).sort(function(n,t){return i.POST(t)-i.POST(n)}),pages:a.filter(t.PAGE).sort(function(n,t){return i.PAGE(t)-i.PAGE(n)}),categories:n.filter(t.CATEGORY).sort(function(n,t){return i.CATEGORY(t)-i.CATEGORY(n)}),tags:o.filter(t.TAG).sort(function(n,t){return i.TAG(t)-i.TAG(n)})}}function e(n){var t,e,r=s.makeArray(c.find(".ins-selectable")),i=-1,n=(r.forEach(function(n,t){s(n).hasClass("active")&&(i=t)}),(r.length+i+n)%r.length);s(r[i]).removeClass("active"),s(r[n]).addClass("active"),0!==(r=s(r[n])).length&&(n=o[0].clientHeight,t=r.position().top-o.scrollTop(),(e=r[0].clientHeight+r.position().top)>n+o.scrollTop()&&o.scrollTop(e-o[0].clientHeight),t<0)&&o.scrollTop(r.position().top)}function r(n){n&&n.length&&(location.href=n.attr("data-url"))}t.parent().remove(".ins-search"),s("body").append(t),s.getJSON(a.CONTENT_URL,function(i){"#ins-search"===location.hash.trim()&&t.addClass("show"),n.on("input",function(){var n,t=s(this).val(),e=t,r=g(i,t);for(n in c.empty(),r)c.append(l(e,n.toUpperCase(),r[n]))}),n.trigger("input")}),s(document).on("click focus",".search-form-input",function(){t.addClass("show"),t.find(".ins-search-input").focus()}).on("click",".ins-search-item",function(){r(s(this))}).on("click",".ins-close",function(){t.removeClass("show")}).on("keydown",function(n){if(t.hasClass("show"))switch(n.keyCode){case 27:t.removeClass("show");break;case 38:e(-1);break;case 40:e(1);break;case 13:r(c.find(".ins-selectable.active").eq(0))}})}(jQuery,window.INSIGHT_CONFIG);